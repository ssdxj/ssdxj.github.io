<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="data pipeline CONFIG DATASET &amp; DATALOADER  DATALOADER DATASET BASEDATASET  MODEL EVALUATION  自定义评测指标  OPTIMWRAPPER PARAMETER SCHEDULER HOOK Runnder REGISTRY RESUME  自动恢复训练 指定 checkpoint 路径">
<meta property="og:type" content="article">
<meta property="og:title" content="mmlab 学习笔记">
<meta property="og:url" content="http://example.com/2025/01/02/mmlab-note/index.html">
<meta property="og:site_name" content="ssdxj&#39;s blogs">
<meta property="og:description" content="data pipeline CONFIG DATASET &amp; DATALOADER  DATALOADER DATASET BASEDATASET  MODEL EVALUATION  自定义评测指标  OPTIMWRAPPER PARAMETER SCHEDULER HOOK Runnder REGISTRY RESUME  自动恢复训练 指定 checkpoint 路径">
<meta property="og:locale">
<meta property="article:published_time" content="2025-01-02T03:57:24.000Z">
<meta property="article:modified_time" content="2025-01-05T08:41:47.092Z">
<meta property="article:author" content="li">
<meta property="article:tag" content="mmlab">
<meta property="article:tag" content="deep learning">
<meta property="article:tag" content="pytorch">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2025/01/02/mmlab-note/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>mmlab 学习笔记 | ssdxj's blogs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">ssdxj's blogs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">hello handsome!!!</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/02/mmlab-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="li">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ssdxj's blogs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          mmlab 学习笔记
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2025-01-02 11:57:24" itemprop="dateCreated datePublished" datetime="2025-01-02T11:57:24+08:00">2025-01-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2025-01-05 16:41:47" itemprop="dateModified" datetime="2025-01-05T16:41:47+08:00">2025-01-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/deap-learning/" itemprop="url" rel="index"><span itemprop="name">deap learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <div class="tocStart">

</div>
<!-- toc -->
<ul>
<li><a href="#data-pipeline">data pipeline</a></li>
<li><a href="#config">CONFIG</a></li>
<li><a href="#dataset-dataloader">DATASET &amp; DATALOADER</a>
<ul>
<li><a href="#dataloader">DATALOADER</a></li>
<li><a href="#dataset">DATASET</a></li>
<li><a href="#basedataset">BASEDATASET</a></li>
</ul></li>
<li><a href="#model">MODEL</a></li>
<li><a href="#evaluation">EVALUATION</a>
<ul>
<li><a href="#zi-ding-yi-ping-ce-zhi-biao">自定义评测指标</a></li>
</ul></li>
<li><a href="#optimwrapper">OPTIMWRAPPER</a></li>
<li><a href="#parameter-scheduler">PARAMETER SCHEDULER</a></li>
<li><a href="#hook">HOOK</a></li>
<li><a href="#runnder">Runnder</a></li>
<li><a href="#registry">REGISTRY</a></li>
<li><a href="#resume">RESUME</a>
<ul>
<li><a href="#zi-dong-hui-fu-xun-lian"><strong>自动恢复训练</strong></a></li>
<li><a href="#zhi-ding-checkpoint-lu-jing"><strong>指定 checkpoint
路径</strong></a></li>
</ul></li>
</ul>
<!-- tocstop -->
<div class="tocEnd">

</div>
<h2><span id="data-pipeline">data pipeline</span><a href="#data-pipeline" class="header-anchor">#</a></h2>
<p>数据传递伪代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 训练过程</span></span><br><span class="line"><span class="keyword">for</span> data_batch <span class="keyword">in</span> train_dataloader:</span><br><span class="line">    data_batch = data_preprocessor(data_batch)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data_batch, <span class="built_in">dict</span>):</span><br><span class="line">        losses = model.forward(**data_batch, mode=<span class="string">&#x27;loss&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(data_batch, (<span class="built_in">list</span>, <span class="built_in">tuple</span>)):</span><br><span class="line">        losses = model.forward(*data_batch, mode=<span class="string">&#x27;loss&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证过程</span></span><br><span class="line"><span class="keyword">for</span> data_batch <span class="keyword">in</span> val_dataloader:</span><br><span class="line">    data_batch = data_preprocessor(data_batch)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data_batch, <span class="built_in">dict</span>):</span><br><span class="line">        outputs = model.forward(**data_batch, mode=<span class="string">&#x27;predict&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(data_batch, (<span class="built_in">list</span>, <span class="built_in">tuple</span>)):</span><br><span class="line">        outputs = model.forward(**data_batch, mode=<span class="string">&#x27;predict&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> TypeError()</span><br><span class="line">    evaluator.process(data_samples=outputs, data_batch=data_batch)</span><br><span class="line">metrics = evaluator.evaluate(<span class="built_in">len</span>(val_dataloader.dataset))</span><br></pre></td></tr></table></figure>
<ul>
<li>默认的 <code>train_step</code>、<code>val_step</code>、<code>test_step</code> 的行为，覆盖了从数据进入 <code>data preprocessor</code> 到 <code>model</code> 输出 <code>loss</code>、<code>predict</code> 结果的这一段流程，不影响其余部分。</li>
<li>虽然在上面的图中分开绘制了数据预处理器和模型，但数据预处理器是模型的一部分(在
<strong>config中的</strong><code>model</code> 里面定义）</li>
<li>模型的前向传播有 3 种模式，由输入参数 <code>mode</code> 控制</li>
</ul>
<h2><span id="config">CONFIG</span><a href="#config" class="header-anchor">#</a></h2>
<ul>
<li><code>MMEngine</code>
实现了抽象的配置类（<code>Config</code>），为用户提供统一的配置访问接口。
<ul>
<li>配置类能够支持不同格式的配置文件，包括 <code>python</code>，<code>json</code>，<code>yaml</code></li>
<li>配置类提供了类似字典或者 Python
对象属性的访问接口（读取和修改）</li>
<li>配置类也实现了一些特性，例如配置文件的字段继承等。</li>
<li>配置类提供了统一的接口 <code>Config.fromfile()</code>，来读取和解析配置文件</li>
</ul></li>
<li>合法的配置文件应该定义一系列键值对</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">test_int = <span class="number">1</span></span><br><span class="line">test_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">test_dict = <span class="built_in">dict</span>(key1=<span class="string">&#x27;value1&#x27;</span>, key2=<span class="number">0.1</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>通过读取配置文件来初始化配置对象后</strong>，就可以像使用普通字典或者
Python 类一样来使用这个变量了。</p></li>
<li><p>我们提供了两种访问接口，即类似字典的接口 <code>cfg['key']</code> 或者类似
Python
对象属性的接口 <code>cfg.key</code>。这两种接口都支持读写。</p></li>
<li><p>注意，配置文件中定义的嵌套字段（即类似字典的字段），在
<code>Config</code> 中会将其转化为 <code>ConfigDict</code>
类，该类继承了 <code>Python</code>
内置字典类型的全部接口，同时也支持以对象属性的方式访问数据。</p></li>
<li><p><strong>配置文件的继承</strong></p>
<ul>
<li><strong><code>_base_</code> 是配置文件的保留字段，指定了该配置文件的继承来源。支持继承多个文件，将同</strong>时获得这多个文件中的所有字段，但是要求继承的多个文件中没有相同名称的字段，否则会报错。</li>
<li>通过这种方式，我们可以将配置文件进行拆分，定义一些通用配置文件，在实际配置文件中继承各种通用配置文件，可以减少具体任务的配置流程。</li>
</ul></li>
<li><p>配置文件（字段）的修改</p>
<ul>
<li>只需要在新的配置文件中，重新定义一下需要修改的字段即可</li>
<li>规则也适用于增加一些下级字段（使用 dict）</li>
</ul></li>
<li><p><strong>配置文件（字典字段中 key）的删除</strong></p>
<ul>
<li>有时候我们对于继承过来的<strong>字典类型字段</strong>，不仅仅是想修改其中某些
key，可能还需要删除其中的一些
key。这时候在重新定义这个字典时，需要指定 <code>_delete_=True</code>，表示将没有在新定义的字典中出现的
key 全部删除。</li>
</ul>
<p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_base_=[<span class="string">&#x27;optimizer_cfg.py&#x27;</span>, <span class="string">&#x27;runtime_cfg.py&#x27;</span>]</span><br><span class="line">model= <span class="built_in">dict</span>(<span class="built_in">type</span>=<span class="string">&#x27;ResNet&#x27;</span>,depth=<span class="number">50</span>)</span><br><span class="line">optimizer= <span class="built_in">dict</span>(_delete_=<span class="literal">True</span>, <span class="built_in">type</span>=<span class="string">&#x27;SGD&#x27;</span>,lr=<span class="number">0.01</span>)</span><br></pre></td></tr></table></figure></p></li>
<li><p>有时我们想重复利用 <code>_base_</code> 中定义的字段内容，就可以通过 <code>&#123;&#123;_base_.xxxx&#125;&#125;</code> 获取来获取对应变量的拷贝。</p></li>
<li><p>在启动训练脚本时，用户可能通过传参的方式来修改配置文件的部分字段，为此我们提供了 <code>dump</code> 接口来导出更改后的配置文件。与读取配置文件类似，用户可以通过 <code>cfg.dump('config.xxx')</code> 来选择导出文件的格式。<code>dump</code> 同样可以导出有继承关系的配置文件，导出的文件可以被独立使用，不再依赖于 <code>_base_</code> 中定义的文件。</p></li>
<li><p>自定义字段</p>
<ul>
<li>有时候我们希望配置文件中的一些字段和当前路径或者文件名等相关</li>
<li>目前支持的预定义字段有以下四种：
<ul>
<li><code>&#123;&#123;fileDirname&#125;&#125;</code> -
当前文件的目录名，例如 <code>/home/your-username/your-project/folder</code></li>
<li><code>&#123;&#123;fileBasename&#125;&#125;</code> -
当前文件的文件名，例如 <code>file.py</code></li>
<li><code>&#123;&#123;fileBasenameNoExtension&#125;&#125;</code> -
当前文件不包含扩展名的文件名，例如 <code>file</code></li>
<li><code>&#123;&#123;fileExtname&#125;&#125;</code> -
当前文件的扩展名，例如 <code>.py</code></li>
</ul></li>
</ul></li>
<li><p><strong>通常，我们使用 <code>type</code>字段 来指定组件的类，并使用其他字段来传递类的初始化参数。<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh_CN/latest/advanced_tutorials/registry.html">注册器教程</a> 对其进行了详细描述。</strong></p></li>
<li><p>预处理配置（<code>data_preprocessor</code>）既可以作为 <code>model</code> 的一个子字段，也可以定义在外部的 <code>data_preprocessor</code> 字段，
同时配置时，优先使用 <code>model.data_preprocessor</code> 的配置。</p></li>
</ul>
<h2><span id="dataset-amp-dataloader">DATASET &amp; DATALOADER</span><a href="#dataset-amp-dataloader" class="header-anchor">#</a></h2>
<ul>
<li>数据加载器（<strong>DataLoader</strong>）是
<strong>MMEngine</strong> 的训练和测试流程中的一个重要组件。
从概念上讲，它源于 <a target="_blank" rel="noopener" href="https://pytorch.org/">PyTorch</a> 并保持一致。<strong>DataLoader</strong>
从文件系统加载数据，原始数据通过数据准备流程后被发送给数据预处理器。</li>
<li>通常来说，
<ul>
<li><strong>数据集(dataset)</strong>
定义了数据的总体数量、读取方式以及预处理，</li>
<li><strong>数据加载器(dataloader)</strong>
则在不同的设置下迭代地加载数据，如批次大小（<code>batch_size</code>）、随机乱序（<code>shuffle</code>）、并行（<code>num_workers</code>）等。</li>
<li>数据集经过数据加载器封装后构成了<strong>数据源</strong>。</li>
</ul></li>
</ul>
<h3><span id="dataloader">DATALOADER</span><a href="#dataloader" class="header-anchor">#</a></h3>
<ul>
<li>在执行器（<code>Runner</code>）中，你可以分别配置以下 3
个参数来指定对应的数据加载器
<ul>
<li><code>train_dataloader</code>：在 <code>Runner.train()</code> 中被使用，为模型提供训练数据</li>
<li><code>val_dataloader</code>：在 <code>Runner.val()</code> 中被使用，也会在 <code>Runner.train()</code> 中每间隔一段时间被使用，用于模型的验证评测</li>
<li><code>test_dataloader</code>：在 <code>Runner.test()</code> 中被使用，用于模型的测试</li>
</ul></li>
<li>MMEngine 完全支持 PyTorch 的原生 <code>DataLoader</code>，因此上述 3
个参数均可以直接传入构建好的 <code>DataLoader</code>。同时，借助
MMEngine 的<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/advanced_tutorials/registry.html">注册机制</a>，以上参数也可以传入 <code>dict</code>，dict中的键值与 <code>DataLoader</code> 的构造参数一一对应。</li>
<li><strong>sampler 与 shuffle</strong>
<ul>
<li>在 MMEngine
中我们要求通过 <code>dict</code> 传入的数据加载器的配置必须包含 <code>sampler</code> 参数。同时，<code>shuffle</code> 参数也从 <code>DataLoader</code> 中移除，这是由于在
PyTorch
中 <code>sampler</code> 与 <code>shuffle</code> 参数是互斥的</li>
<li>事实上，在 PyTorch
的实现中，<code>shuffle</code> 只是一个便利记号。当设置为 <code>True</code> 时 <code>DataLoader</code> 会自动在内部使用 <code>RandomSampler</code></li>
<li><code>DefaultSampler</code> 是 MMEngine
内置的一种采样器，它屏蔽了单进程训练与多进程训练的细节差异，使得单卡与多卡训练可以无缝切换</li>
<li><code>DefaultSampler</code> 适用于绝大部分情况，并且我们保证在执行器中使用它时，随机数等容易出错的细节都被正确地处理，防止你陷入多进程训练的常见陷阱。</li>
</ul></li>
<li><code>collate_fn</code> 这一参数常常被使用者忽略，但在 MMEngine
中你需要额外注意：当你传入 <code>dict</code> 来构造数据加载器时，MMEngine
会默认使用内置的 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh_CN/latest/api/generated/mmengine.dataset.pseudo_collate.html#mmengine.dataset.pseudo_collate">pseudo_collate</a>，这一点明显区别于
PyTorch 默认的 <a target="_blank" rel="noopener" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.default_collate">default_collate</a>。因此，当你迁移
PyTorch
项目时，需要在配置文件中手动指明 <code>collate_fn</code> 以保持行为一致</li>
<li>MMengine 中提供了 2 种内置的 <code>collate_fn</code>：
<ul>
<li><code>pseudo_collate</code>，缺省时的默认参数。它不会将数据沿着 <code>batch</code> 的维度合并。详细说明可以参考 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.dataset.pseudo_collate.html#mmengine.dataset.pseudo_collate">pseudo_collate</a></li>
<li><code>default_collate</code>，与 PyTorch
中的 <code>default_collate</code> 行为几乎完全一致，会将数据转化为 <code>Tensor</code> 并沿着 <code>batch</code> 维度合并。一些细微不同和详细说明可以参考 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.dataset.default_collate.html#mmengine.dataset.default_collate">default_collate</a></li>
</ul></li>
</ul>
<h3><span id="dataset">DATASET</span><a href="#dataset" class="header-anchor">#</a></h3>
<ul>
<li><code>torchvision</code> 中提供了丰富的公开数据集，它们都可以在
MMEngine 中直接使用</li>
<li>但是，当需要将上述示例转换为配置文件时，你需要对 <code>torchvision</code> 中的数据集进行额外的注册。</li>
<li>如果你同时用到了 <code>torchvision</code> 中的数据预处理模块，那么你也需要编写额外代码来对它们进行注册和构建。</li>
</ul>
<h3><span id="basedataset">BASEDATASET</span><a href="#basedataset" class="header-anchor">#</a></h3>
<ul>
<li><p>因此 MMEngine 实现了一个数据集基类（<code>BaseDataset</code>）并定义了一些基本接口，且基于这套接口实现了一些数据集包装（<code>DatasetWrapper</code>）。<code>OpenMMLab</code>
算法库中的大部分数据集都会满足这套数据集基类定义的接口，并使用统一的数据集包装。</p></li>
<li><p><strong>数据集基类中包含的 <code>parse_data_info()</code> 方法用于将标注文件里的一个原始数据处理成一个或若干个训练/测试样本的方法。因此对于自定义数据集类，用户需要实现 <code>parse_data_info()</code> 方法。</strong></p></li>
<li><p>与 <code>torch.utils.data.Dataset</code> 类似，数据集初始化后，支持 <code>__getitem__</code> 方法，用来索引数据，以及 <code>__len__</code> 操作获取数据集大小，除此之外，OpenMMLab
的数据集基类主要提供了以下接口来访问具体信息：</p>
<ul>
<li><code>metainfo</code>：返回元信息，返回值为字典</li>
<li><code>get_data_info(idx)</code>：返回指定 <code>idx</code> 的样本全量信息，返回值为字典</li>
<li><code>__getitem__(idx)</code>：返回指定 <code>idx</code> 的样本经过
pipeline 之后的结果（也就是送入模型的数据），返回值为字典</li>
<li><code>__len__()</code>：返回数据集长度，返回值为整数型</li>
<li><code>get_subset_(indices)</code>：根据 <code>indices</code> 以
inplace
的方式修改原数据集类。如果 <code>indices</code> 为 <code>int</code>，则原数据集类只包含前若干个数据样本；如果 <code>indices</code> 为 <code>Sequence[int]</code>，则原数据集类包含根据 <code>Sequence[int]</code> 指定的数据样本。</li>
<li><code>get_subset(indices)</code>：根据 <code>indices</code> 以非 inplace
的方式返回子数据集类，即重新复制一份子数据集。如果 <code>indices</code> 为 <code>int</code>，则返回的子数据集类只包含前若干个数据样本；如果 <code>indices</code> 为 <code>Sequence[int]</code>，则返回的子数据集类包含根据 <code>Sequence[int]</code> 指定的数据样本。</li>
</ul></li>
<li><p>数据集基类的基本功能是加载数据集信息，这里我们将数据集信息分成两类</p>
<ul>
<li>一种是元信息 (meta
information)，代表数据集自身相关的信息，有时需要被模型或其他外部组件获取，比如在图像分类任务中，数据集的元信息一般包含类别信息 <code>classes</code>，因为分类模型 <code>model</code> 一般需要记录数据集的类别信息；</li>
<li>另一种为数据信息 (data
information)，在数据信息中，定义了具体样本的文件路径、对应标签等的信息。</li>
</ul></li>
<li><p>除此之外，数据集基类的另一个功能为不断地将数据送入数据流水线（data
pipeline）中，进行数据预处理。</p></li>
<li><p>数据集基类的初始化流程</p></li>
<li><p><code>load metainfo</code>：获取数据集的元信息，元信息有三种来源，优先级从高到低为：</p>
<ul>
<li><code>__init__()</code> 方法中用户传入的 <code>metainfo</code> 字典；改动频率最高，因为用户可以在实例化数据集时，传入该参数；</li>
<li>类属性 <code>BaseDataset.METAINFO</code> 字典；改动频率中等，因为用户可以改动自定义数据集类中的类属性 <code>BaseDataset.METAINFO</code>；</li>
<li>标注文件中包含的 <code>metainfo</code> 字典；改动频率最低，因为标注文件一般不做改动。如果三种来源中有相同的字段，优先级最高的来源决定该字段的值，这些字段的优先级比较是：用户传入的 <code>metainfo</code> 字典里的字段
&gt; <code>BaseDataset.METAINFO</code> 字典里的字段 &gt;
标注文件中 <code>metainfo</code> 字典里的字段。</li>
</ul></li>
<li><p><code>join path</code>：处理数据与标注文件的路径；</p></li>
<li><p><code>build pipeline</code>：构建数据流水线（data
pipeline），用于数据预处理与数据准备；</p></li>
<li><p><code>full init</code>：完全初始化数据集类，该步骤主要包含以下操作：</p>
<ul>
<li><code>load data list</code>：读取与解析满足 OpenMMLab 2.0
数据集格式规范的标注文件，该步骤中会调用 <code>parse_data_info()</code> 方法，该方法负责解析标注文件里的每个原始数据；</li>
<li><code>filter data</code> (可选)：根据 <code>filter_cfg</code> 过滤无用数据，比如不包含标注的样本等；默认不做过滤操作，下游子类可以按自身所需对其进行重写；</li>
<li><code>get subset</code> (可选)：根据给定的索引或整数值采样数据，比如只取前
10 个样本参与训练/测试；默认不采样数据，即使用全部数据样本；</li>
<li><code>serialize data</code> (可选)：序列化全部样本，以达到节省内存的效果，详情请参考<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/advanced_tutorials/basedataset.html#id10">节省内存</a>；默认操作为序列化全部样本。</li>
</ul></li>
<li><p>OpenMMLab 2.0 数据集格式规范规定:</p>
<ul>
<li>标注文件必须为 <code>json</code> 或 <code>yaml</code>，<code>yml</code> 或 <code>pickle</code>，<code>pkl</code> 格式；</li>
<li>标注文件中存储的字典必须包含 <code>metainfo</code> 和 <code>data_list</code> 两个字段。</li>
<li>其中 <code>metainfo</code> 是一个字典，里面包含数据集的元信息；</li>
<li><code>data_list</code> 是一个列表，列表中每个元素是一个字典，该字典定义了一个原始数据（raw
data），每个原始数据包含一个或若干个训练/测试样本。</li>
</ul></li>
</ul>
<h2><span id="model">MODEL</span><a href="#model" class="header-anchor">#</a></h2>
<ul>
<li>在基于 MMEngine
开发时，定义的模型由执行器(<code>runner</code>)管理，且需要实现 <code>train_step</code>、<code>val_step</code> 和 <code>test_step</code> 方法。</li>
<li>对于检测、识别、分割一类的深度学习任务，上述方法通常为标准的流程，例如在 <code>train_step</code> 里更新参数，返回损失；<code>val_step</code> 和 <code>test_step</code> 返回预测结果。</li>
<li><strong>因此 MMEngine 抽象出模型基类 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.model.BaseModel.html#mmengine.model.BaseModel">BaseModel</a>，实现了上述接口的标准流程</strong></li>
<li>得益于 <code>BaseModel</code> 我们只需要让模型继承自模型基类，并按照一定的规范实现 <code>forward</code>，就能让模型在执行器中运行起来。</li>
<li><code>forward</code>
<ul>
<li><code>forward</code> 的入参需通常需要和 <a target="_blank" rel="noopener" href="https://pytorch.org/tutorials/beginner/basics/data_tutorial.html">DataLoader</a> 的输出保持一致
(自定义<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/tutorials/model.html#datapreprocessor">数据预处理器</a>除外)，
<ul>
<li><code>DataLoader</code> 返回元组类型的数据 <code>data</code>，<code>forward</code> 需要能够接受 <code>*data</code> 的解包后的参数；</li>
<li>如果返回字典类型的数据 <code>data</code>，<code>forward</code> 需要能够接受 <code>**data</code> 解包后的参数。</li>
<li><code>mode</code> 参数用于控制 forward 的返回结果
<ul>
<li><code>mode='loss'</code>：<code>loss</code> 模式通常在训练阶段启用，并返回一个损失字典。损失字典的
key-value
分别为损失名和可微的 <code>torch.Tensor</code>。字典中记录的损失会被用于更新参数和记录日志。模型基类会在 <code>train_step</code> 方法中调用该模式的 <code>forward</code>。</li>
<li><code>mode='predict'</code>： <code>predict</code> 模式通常在验证、测试阶段启用，并返回列表/元组形式的预测结果，预测结果需要和 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.evaluator.Evaluator.html#mmengine.evaluator.Evaluator.process">process</a> 接口的参数相匹配。OpenMMLab
系列算法对 <code>predict</code> 模式的输出有着更加严格的约定，需要输出列表形式的<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/advanced_tutorials/data_element.html">数据元素</a>。模型基类会在 <code>val_step</code>，<code>test_step</code> 方法中调用该模式的 <code>forward</code>。</li>
<li><code>mode='tensor'</code>：<code>tensor</code> 和 <code>predict</code> 模式均返回模型的前向推理结果，区别在于 <code>tensor</code> 模式下，<code>forward</code> 会返回未经后处理的张量，例如返回未经非极大值抑制（nms）处理的检测结果，返回未经 <code>argmax</code> 处理的分类结果。我们可以基于 <code>tensor</code> 模式的结果进行自定义的后处理。</li>
</ul></li>
</ul></li>
</ul></li>
<li><code>train_step</code>:
执行 <code>forward</code> 方法的 <code>loss</code> 分支，得到损失字典。模型基类基于<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/tutorials/optim_wrapper.html">优化器封装</a> 实现了标准的梯度计算、参数更新、梯度清零流程。其等效伪代码如下：</li>
<li><code>val_step</code>:
执行 <code>forward</code> 方法的 <code>predict</code> 分支，返回预测结果：**</li>
<li><code>test_step</code>: 同 <code>val_step</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">val_step</span>(<span class="params">self, data, optim_wrapper</span>):</span><br><span class="line">    data = <span class="variable language_">self</span>.data_preprocessor(data, training=<span class="literal">False</span>)</span><br><span class="line">    outputs = <span class="variable language_">self</span>(**data, mode=<span class="string">&#x27;predict&#x27;</span>) <span class="comment"># 预测模式，返回预测结果</span></span><br><span class="line">    <span class="keyword">return</span> outputs</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train_step</span>(<span class="params">self, data, optim_wrapper</span>):</span><br><span class="line">    data = <span class="variable language_">self</span>.data_preprocessor(data, training=<span class="literal">True</span>)  <span class="comment"># 按下不表，详见数据与处理器一节</span></span><br><span class="line">    loss = <span class="variable language_">self</span>(**data, mode=<span class="string">&#x27;loss&#x27;</span>)  <span class="comment"># loss 模式，返回损失字典，假设 data 是字典，使用 ** 进行解析。事实上 train_step 兼容 tuple 和 dict 类型的输入。</span></span><br><span class="line">    parsed_losses, log_vars = <span class="variable language_">self</span>.parse_losses() <span class="comment"># 解析损失字典，返回可以 backward 的损失以及可以被日志记录的损失</span></span><br><span class="line">    optim_wrapper.update_params(parsed_losses)  <span class="comment"># 更新参数</span></span><br><span class="line">    <span class="keyword">return</span> log_vars</span><br></pre></td></tr></table></figure>
<h2><span id="evaluation">EVALUATION</span><a href="#evaluation" class="header-anchor">#</a></h2>
<ul>
<li>在模型验证和模型测试中，通常需要对模型精度做定量评测。我们可以通过在配置文件中指定评测指标（<code>Metric</code>）来实现这一功能。</li>
<li>在基于 MMEngine
进行模型训练或测试时，用户只需要在配置文件中通过 <code>val_evaluator</code> 和 <code>test_evaluator</code> 2
个字段分别指定模型验证和测试阶段的评测指标即可</li>
<li>如果需要同时评测多个指标，也可以将 <code>val_evaluator</code> 或 <code>test_evaluator</code> 设置为一个列表，其中每一项为一个评测指标的配置信息。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">test_evaluator = [</span><br><span class="line">    <span class="comment"># 目标检测指标</span></span><br><span class="line">    <span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=<span class="string">&#x27;CocoMetric&#x27;</span>,</span><br><span class="line">        metric=[<span class="string">&#x27;bbox&#x27;</span>, <span class="string">&#x27;segm&#x27;</span>],</span><br><span class="line">        ann_file=<span class="string">&#x27;annotations/instances_val2017.json&#x27;</span>,</span><br><span class="line">    ),</span><br><span class="line">    <span class="comment"># 全景分割指标</span></span><br><span class="line">    <span class="built_in">dict</span>(</span><br><span class="line">        <span class="built_in">type</span>=<span class="string">&#x27;CocoPanopticMetric&#x27;</span>,</span><br><span class="line">        ann_file=<span class="string">&#x27;annotations/panoptic_val2017.json&#x27;</span>,</span><br><span class="line">        seg_prefix=<span class="string">&#x27;annotations/panoptic_val2017&#x27;</span>,</span><br><span class="line">    )</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3><span id="zi-ding-yi-ping-ce-zhi-biao">自定义评测指标</span><a href="#zi-ding-yi-ping-ce-zhi-biao" class="header-anchor">#</a></h3>
<ul>
<li>需要继承基类 <a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.evaluator.BaseMetric.html#mmengine.evaluator.BaseMetric">BaseMetric</a></li>
<li>此外，评测指标类需要用注册器 <code>METRICS</code> 进行注册</li>
<li>实现 <code>process()</code> 方法。该方法有 2
个输入参数，分别是一个批次的测试数据样本 <code>data_batch</code> 和模型预测结果 <code>data_samples</code>。我们从中分别取出样本类别标签和分类预测结果，并存放在 <code>self.results</code> 中。</li>
<li>实现 <code>compute_metrics()</code> 方法。该方法有 1
个输入参数 <code>results</code>，里面存放了所有批次测试数据经过 <code>process()</code> 方法处理后得到的结果。从中取出样本类别标签和分类预测结果，即可计算得到分类正确率 <code>acc</code>。最终，将计算得到的评测指标以字典的形式返回。</li>
<li>（可选）可以为类属性 <code>default_prefix</code> 赋值。该属性会自动作为输出的评测指标名前缀（如 <code>defaut_prefix='my_metric'</code>,则实际输出的评测指标名为 <code>'my_metric/acc'</code>），用以进一步区分不同的评测指标。该前缀也可以在配置文件中通过 <code>prefix</code> 参数改写。我们建议在
docstring
中说明该评测指标类的 <code>default_prefix</code> 值以及所有的返回指标名称。</li>
</ul>
<h2><span id="optimwrapper">OPTIMWRAPPER</span><a href="#optimwrapper" class="header-anchor">#</a></h2>
<ul>
<li>是 <code>Pytorch</code>
原生优化器（<code>Optimizer</code>）高级抽象</li>
<li>它在增加了更多功能的同时，提供了一套统一的接口。</li>
<li>优化器封装支持不同的训练策略，包括混合精度训练、梯度累加和梯度截断。我们可以根据需求选择合适的训练策略。</li>
<li>优化器封装还定义了一套标准的参数更新流程，用户可以基于这一套流程，实现同一套代码，不同训练策略的切换。</li>
<li><strong>优化器封装的 <code>update_params</code> 实现了标准的梯度计算(<code>loss.backward()</code>)、参数更新(<code>optimizer.step()</code>)和梯度清零(<code>optimizer.zero()</code>)流程，可以直接用来更新模型参数。</strong></li>
</ul>
<h2><span id="parameter-scheduler">PARAMETER SCHEDULER</span><a href="#parameter-scheduler" class="header-anchor">#</a></h2>
<ul>
<li>在模型训练过程中，我们往往不是采用固定的优化参数，例如学习率等，会随着训练轮数的增加进行调整。</li>
<li>最简单常见的学习率调整策略就是阶梯式下降，例如每隔一段时间将学习率降低为原来的几分之一。</li>
<li>PyTorch 中有学习率调度器 <code>LRScheduler</code>
来对各种不同的学习率调整方式进行抽象，但支持仍然比较有限，</li>
<li>在 MMEngine 中，我们对其进行了拓展，实现了更通用的<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh-cn/latest/api/generated/mmengine.optim._ParamScheduler.html#mmengine.optim._ParamScheduler">参数调度器</a>，可以对学习率、动量等优化器相关的参数进行调整，并且支持多个调度器进行组合，应用更复杂的调度策略。</li>
</ul>
<h2><span id="hook">HOOK</span><a href="#hook" class="header-anchor">#</a></h2>
<ul>
<li>钩子编程是一种编程模式，是指在程序的一个或者多个位置设置位点（挂载点），当程序运行至某个位点时，会自动调用运行时注册到位点的所有方法。钩子编程可以提高程序的灵活性和拓展性，用户将自定义的方法注册到位点便可被调用而无需修改程序中的代码。</li>
<li></li>
</ul>
<h2><span id="runnder">Runnder</span><a href="#runnder" class="header-anchor">#</a></h2>
<ul>
<li>使用配置文件时，你通常不需要手动注册所有模块。例如，<code>torch.optim</code> 中的所有优化器（如 <code>Adam</code> <code>SGD</code>等）都已经在 <code>mmengine.optim</code> 中注册完成。使用时的经验法则是：尝试直接使用 <code>PyTorch</code> 中的组件，只有当出现报错时再手动注册。</li>
<li>当使用配置文件写法时，你的自定义模块的实现代码通常存放在独立文件中，可能并未被正确注册，进而导致构建失败。我们推荐你阅读<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh_CN/latest/advanced_tutorials/config.html#python">配置</a>文档中 <code>custom_imports</code> 相关的内容以更好地使用配置文件系统。</li>
</ul>
<h2><span id="registry">REGISTRY</span><a href="#registry" class="header-anchor">#</a></h2>
<ul>
<li>MMEngine 实现的<a target="_blank" rel="noopener" href="https://mmengine.readthedocs.io/zh_CN/latest/api/generated/mmengine.registry.Registry.html#mmengine.registry.Registry">注册器</a>可以看作一个映射表和模块构建方法（build
function）的组合。
<ul>
<li>映射表维护了一个字符串到类或者函数的映射，使得用户可以借助字符串查找到相应的类或函数，例如维护字符串 <code>"ResNet"</code> 到 <code>ResNet</code> 类或函数的映射，使得用户可以通过 <code>"ResNet"</code> 找到 <code>ResNet</code> 类；</li>
<li>而模块构建方法则定义了如何根据字符串查找到对应的类或函数以及如何实例化这个类或者调用这个函数，例如，通过字符串 <code>"bn"</code> 找到 <code>nn.BatchNorm2d</code> 并实例化 <code>BatchNorm2d</code> 模块；又或者通过字符串 <code>"build_batchnorm2d"</code> 找到 <code>build_batchnorm2d</code> 函数并返回该函数的调用结果</li>
<li>一个注册器管理的类或函数通常有相似的接口和功能，因此该注册器可以被视作这些类或函数的抽象。例如注册器 <code>MODELS</code> 可以被视作所有模型的抽象，管理了 <code>ResNet</code>，<code>SEResNet</code> 和 <code>RegNetX</code> 等分类网络的类以及 <code>build_ResNet</code>, <code>build_SEResNet</code> 和 <code>build_RegNetX</code> 等分类网络的构建函数。</li>
</ul></li>
</ul>
<h2><span id="resume">RESUME</span><a href="#resume" class="header-anchor">#</a></h2>
<ul>
<li>恢复的状态包括<strong>模型的权重、优化器和优化器参数调整策略的状态。</strong></li>
</ul>
<h3><span id="zi-dong-hui-fu-xun-lian"><strong>自动恢复训练</strong></span><a href="#zi-dong-hui-fu-xun-lian" class="header-anchor">#</a></h3>
<ul>
<li>设置 <code>Runner</code> 的 <code>resume</code> 等于 <code>True</code>，<code>Runner</code> 会从 <code>work_dir</code> 中加载最新的
checkpoint。如果 <code>work_dir</code> 中有最新的
checkpoint（例如该训练在上一次训练时被中断），则会从该 checkpoint
恢复训练，否则（例如上一次训练还没来得及保存 checkpoint
或者启动了新的训练任务）会重新开始训练。</li>
</ul>
<h3><span id="zhi-ding-checkpoint-lu-jing"><strong>指定 checkpoint 路径</strong></span><a href="#zhi-ding-checkpoint-lu-jing" class="header-anchor">#</a></h3>
<ul>
<li>如果希望指定恢复训练的路径，除了设置 <code>resume=True</code>，还需要设置 <code>load_from</code> 参数。需要注意的是，如果只设置了 <code>load_from</code> 而没有设置 <code>resume=True</code>，则只会加载
checkpoint 中的权重并重新开始训练，而不是接着之前的状态继续训练。</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/mmlab/" rel="tag"># mmlab</a>
              <a href="/tags/deep-learning/" rel="tag"># deep learning</a>
              <a href="/tags/pytorch/" rel="tag"># pytorch</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/01/02/ubuntu-others/" rel="prev" title="Ubuntu 中奇奇怪怪的问题">
      <i class="fa fa-chevron-left"></i> Ubuntu 中奇奇怪怪的问题
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/01/02/python-setup/" rel="next" title="Python 设置">
      Python 设置 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">data pipeline</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">2.</span> <span class="nav-text">CONFIG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">3.</span> <span class="nav-text">DATASET &amp; DATALOADER</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">3.1.</span> <span class="nav-text">DATALOADER</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">3.2.</span> <span class="nav-text">DATASET</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">3.3.</span> <span class="nav-text">BASEDATASET</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">4.</span> <span class="nav-text">MODEL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">5.</span> <span class="nav-text">EVALUATION</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">5.1.</span> <span class="nav-text">自定义评测指标</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">6.</span> <span class="nav-text">OPTIMWRAPPER</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">7.</span> <span class="nav-text">PARAMETER SCHEDULER</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">8.</span> <span class="nav-text">HOOK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">9.</span> <span class="nav-text">Runnder</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">10.</span> <span class="nav-text">REGISTRY</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">11.</span> <span class="nav-text">RESUME</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">11.1.</span> <span class="nav-text">自动恢复训练</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">11.2.</span> <span class="nav-text">指定 checkpoint 路径</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">li</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">li</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

</body>
</html>
